module Intersections.CubeGSD
  where
import           Data.List                    (union)
import           Data.Tuple.Extra             (both)
import           Graphics.Rendering.OpenGL.GL (GLfloat, Vertex3 (..))

vertices :: [Vertex3 GLfloat]
vertices =  [ Vertex3 (-1.0) (-0.6180339887498948) 0.0
            , Vertex3 (-1.0) (-0.6180339887498948) 6.790144004603132e-17
            , Vertex3
                (-0.6180339887498948) (-0.6180339887498948) 0.6180339887498948
            , Vertex3 (-6.790144004603132e-17) (-1.0) 0.6180339887498948
            , Vertex3 (-0.38196601125010515) (-1.0) 0.0
            , Vertex3 (-6.790144004603132e-17) (-1.0) (-0.6180339887498948)
            , Vertex3
                (-0.6180339887498948) (-0.6180339887498948) (-0.6180339887498948)
            , Vertex3 (-1.0) (-0.6180339887498948) (-6.790144004603132e-17)
            , Vertex3 (-1.0) 0.0 (-0.38196601125010515)
            , Vertex3 (-1.0) 0.6180339887498948 (-6.790144004603132e-17)
            , Vertex3 (-1.0) 0.6180339887498948 0.0
            , Vertex3 (-1.0) 0.6180339887498948 6.790144004603132e-17
            , Vertex3 (-1.0) 0.0 0.38196601125010515
            , Vertex3 (-0.6180339887498948) 0.0 1.0
            , Vertex3 (-0.6180339887498948) (-6.790144004603132e-17) 1.0
            , Vertex3 0.0 (-0.38196601125010515) 1.0
            , Vertex3 0.0 (-1.0) 0.6180339887498948
            , Vertex3 6.790144004603132e-17 (-1.0) 0.6180339887498948
            , Vertex3 0.38196601125010515 (-1.0) 0.0
            , Vertex3 6.790144004603132e-17 (-1.0) (-0.6180339887498948)
            , Vertex3 0.0 (-1.0) (-0.6180339887498948)
            , Vertex3 0.0 (-0.38196601125010515) (-1.0)
            , Vertex3 (-0.6180339887498948) (-6.790144004603132e-17) (-1.0)
            , Vertex3 (-0.6180339887498948) 0.0 (-1.0)
            , Vertex3 (-0.6180339887498948) 6.790144004603132e-17 (-1.0)
            , Vertex3
                (-0.6180339887498948) 0.6180339887498948 (-0.6180339887498948)
            , Vertex3 (-6.790144004603132e-17) 1.0 (-0.6180339887498948)
            , Vertex3 (-0.38196601125010515) 1.0 0.0
            , Vertex3 (-6.790144004603132e-17) 1.0 0.6180339887498948
            , Vertex3
                (-0.6180339887498948) 0.6180339887498948 0.6180339887498948
            , Vertex3 (-0.6180339887498948) 6.790144004603132e-17 1.0
            , Vertex3 0.0 0.38196601125010515 1.0
            , Vertex3 0.6180339887498948 6.790144004603132e-17 1.0
            , Vertex3 0.6180339887498948 0.0 1.0
            , Vertex3 0.6180339887498948 (-6.790144004603132e-17) 1.0
            , Vertex3
                0.6180339887498948 (-0.6180339887498948) 0.6180339887498948
            , Vertex3 1.0 (-0.6180339887498948) 6.790144004603132e-17
            , Vertex3 1.0 (-0.6180339887498948) 0.0
            , Vertex3 1.0 (-0.6180339887498948) (-6.790144004603132e-17)
            , Vertex3
                0.6180339887498948 (-0.6180339887498948) (-0.6180339887498948)
            , Vertex3 0.6180339887498948 (-6.790144004603132e-17) (-1.0)
            , Vertex3 0.6180339887498948 0.0 (-1.0)
            , Vertex3 0.6180339887498948 6.790144004603132e-17 (-1.0)
            , Vertex3 0.0 0.38196601125010515 (-1.0)
            , Vertex3 0.0 1.0 (-0.6180339887498948)
            , Vertex3 6.790144004603132e-17 1.0 (-0.6180339887498948)
            , Vertex3 0.38196601125010515 1.0 0.0
            , Vertex3 6.790144004603132e-17 1.0 0.6180339887498948
            , Vertex3 0.0 1.0 0.6180339887498948
            , Vertex3 0.6180339887498948 0.6180339887498948 0.6180339887498948
            , Vertex3 1.0 0.6180339887498948 6.790144004603132e-17
            , Vertex3 1.0 0.0 0.38196601125010515
            , Vertex3 1.0 0.6180339887498948 0.0
            , Vertex3 1.0 0.6180339887498948 (-6.790144004603132e-17)
            , Vertex3 1.0 0.0 (-0.38196601125010515)
            , Vertex3
                0.6180339887498948 0.6180339887498948 (-0.6180339887498948)
            ]

polygonsIdxs :: [[Int]]
polygonsIdxs =  [ [ 1 , 0 , 4 , 3 , 2 ]
                , [ 4 , 0 , 7 , 6 , 5 ]
                , [ 7 , 0 , 1 , 12 , 11 , 10 , 9 , 8 ]
                , [ 12 , 1 , 2 , 14 , 13 ]
                , [ 14 , 2 , 3 , 16 , 15 ]
                , [ 3 , 4 , 5 , 20 , 19 , 18 , 17 , 16 ]
                , [ 5 , 6 , 22 , 21 , 20 ]
                , [ 6 , 7 , 8 , 23 , 22 ]
                , [ 23 , 8 , 9 , 25 , 24 ]
                , [ 25 , 9 , 10 , 27 , 26 ]
                , [ 10 , 11 , 29 , 28 , 27 ]
                , [ 11 , 12 , 13 , 30 , 29 ]
                , [ 30 , 13 , 14 , 15 , 34 , 33 , 32 , 31 ]
                , [ 15 , 16 , 17 , 35 , 34 ]
                , [ 35 , 17 , 18 , 37 , 36 ]
                , [ 18 , 19 , 39 , 38 , 37 ]
                , [ 19 , 20 , 21 , 40 , 39 ]
                , [ 22 , 23 , 24 , 43 , 42 , 41 , 40 , 21 ]
                , [ 24 , 25 , 26 , 44 , 43 ]
                , [ 26 , 27 , 28 , 48 , 47 , 46 , 45 , 44 ]
                , [ 28 , 29 , 30 , 31 , 48 ]
                , [ 48 , 31 , 32 , 49 , 47 ]
                , [ 49 , 32 , 33 , 51 , 50 ]
                , [ 33 , 34 , 35 , 36 , 51 ]
                , [ 36 , 37 , 38 , 54 , 53 , 52 , 50 , 51 ]
                , [ 39 , 40 , 41 , 54 , 38 ]
                , [ 41 , 42 , 55 , 53 , 54 ]
                , [ 42 , 43 , 44 , 45 , 55 ]
                , [ 55 , 45 , 46 , 52 , 53 ]
                , [ 46 , 47 , 49 , 50 , 52 ]
                ]

edgesIdxs :: [(Int,Int)]
edgesIdxs = foldr (union . (\idxs -> (last idxs, head idxs) : zip (init idxs) (tail idxs))) [] polygonsIdxs

polygons :: [[Vertex3 GLfloat]]
polygons = map (\idxs -> [vertices !! i | i <- idxs]) polygonsIdxs

edges :: [(Vertex3 GLfloat, Vertex3 GLfloat)]
edges = map (both (vertices !!)) edgesIdxs
